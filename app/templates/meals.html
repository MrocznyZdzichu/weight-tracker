{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>Posiłki dzisiaj</h2>
  <form action="/meals/add" method="post">
    <label>Nazwa produktu:
      <input type="text" name="name" placeholder="np. jabłko, kanapka" required>
    </label>
    <br/><br/>
    <label>Kcal:
      <input type="number" name="kcal" min="1" max="5000" step="1" placeholder="np. 250" required>
    </label>
    <br/><br/>
    <button type="submit" class="btn">Dodaj posiłek</button>
    <a href="/kcal" class="btn btn-secondary" style="margin-left:8px">Znajdź kalorie</a>
  </form>

  <hr/>

  <h3>Podsumowanie dnia ({{ today }})</h3>
  <p>Cel: <strong>{{ goal }}</strong> kcal &nbsp;|&nbsp; Zjedzone: <strong>{{ total }}</strong> kcal &nbsp;|&nbsp; Pozostało: <strong>{{ remaining }}</strong> kcal</p>

  <form action="/meals/goal" method="post" style="margin-top:8px;">
    <label>Ustaw dzienny cel (kcal):
      <input type="number" name="goal" min="800" max="10000" step="50" value="{{ goal }}" required>
    </label>
    <button type="submit" class="btn">Zapisz cel</button>
  </form>

  {% if meals %}
    <h3>Zjedzone dziś</h3>
    <ul class="meals-list">
    {% for m in meals %}
      <li class="meal-item">
        <form action="/meals/edit/{{ m.id }}" method="post" class="edit-form">
          <input type="text" name="name" value="{{ m.name }}" required>
          <input type="number" name="kcal" min="1" max="5000" step="1" value="{{ m.kcal }}" required>
          <button type="submit" class="btn btn-sm">Zapisz</button>
        </form>
        <form action="/meals/delete/{{ m.id }}" method="post" class="delete-form">
          <button type="submit" class="btn btn-secondary btn-sm" onclick="return confirm('Usunąć ten wpis?')">Usuń</button>
        </form>
      </li>
    {% endfor %}
    </ul>
  {% else %}
    <p>Brak posiłków dodanych dzisiaj.</p>
  {% endif %}
</div>
{% endblock %}
